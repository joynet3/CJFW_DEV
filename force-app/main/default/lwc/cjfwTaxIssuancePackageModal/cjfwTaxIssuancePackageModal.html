<!--
  @description       : 세금계산서 발행 Tab Main > 신규발행 Btn > "일괄 발행" 화면 
  @author            : joohyeon.jang@dkbmc.com
  @group             : 
  @last modified on  : 08-09-2023
  @last modified by  : joohyeon.jang@dkbmc.com
  Modifications Log
  Ver   Date         Author                    Modification
  1.0   08-08-2023   joohyeon.jang@dkbmc.com   Initial Version
-->
<template>
    <Template lwc:if={showModal}>
        <!-- #Header -->
        <lightning-modal-header label="일괄 발행">
        </lightning-modal-header>
        
        <!-- #Body -->
        <lightning-modal-body>
            <!-- 상단 영역 -->
            <lightning-card label="Tax Issuance Status Search" icon-name="utility:form"  title="세금계산서 일괄 발행" type="media" href="#" class="list_view_container" style="background-color: #F3F3F3 ;">
            <!-- 상단 영역 End -->

                <!-- 필터 영역 -->
                <lightning-layout style="padding-bottom: 1rem; background-color: #F3F3F3;">
                    <lightning-layout multiple-rows="true">
                        <lightning-layout-item size="2" padding="around-small" >
                            <c-comm-custom-select
                                is-required
                                is-empty-option
                                options={headOfficeOptions}
                                label="본부"
                                onselected={handleSelectedHead}
                                >
                             </c-comm-custom-select>
                        </lightning-layout-item>
                        <lightning-layout-item size="2" padding="around-small" >
                            <c-comm-custom-select 
                                is-empty-option
                                options={suOptions}
                                label="SU"
                                onselected={handleSelectedSu}
                                >
                             </c-comm-custom-select>
                        </lightning-layout-item>

                        <lightning-layout-item size="2" padding="around-small" >
                            <c-comm-custom-select 
                                is-empty-option
                                options={teamOptions}
                                label="팀"
                                onselected={handleSelectedTeam}
                                >
                             </c-comm-custom-select>
                        </lightning-layout-item>
                        <lightning-layout-item size="2" padding="around-small" >
                            <lightning-input label="고객사" name="enter-search" type="search" value={singleSearchKey} onchange={changeHandleSearch} onkeypress={handleEnter} onfocus={handleClick}></lightning-input>
                        </lightning-layout-item>
                        <lightning-layout-item size="2" padding="around-small" >
                            <lightning-input label="　" name="enter-search" type="search" value={singleSearchEmpNum} onchange={changeHandleSearch} onkeypress={handleEnter}  ></lightning-input>
                        </lightning-layout-item>
                        <lightning-layout-item size="2" padding="around-small" >
                        </lightning-layout-item>

                        <lightning-layout-item size="2" padding="around-small" >
                            <lightning-input label ="증빙일자" type ="date"  value ={singleFirstDayOfMonthDate} onchange={changeFromIssueData} field-level-help={helpText} required></lightning-input>
                        </lightning-layout-item>
                        <lightning-layout-item size="2" padding="around-small" >
                            <lightning-input label ="　" type ="date"  value ={singleTodayDate} onchange={changeToIssueData} field-level-help={helpText}></lightning-input>
                        </lightning-layout-item>
                       <lightning-layout-item size="2" padding="around-small" >
                            <c-comm-custom-select 
                                is-empty-option
                                options={typeOptions}
                                label="계산서 구분"
                                onselected={handleSelectedType}
                                >
                             </c-comm-custom-select>
                        </lightning-layout-item>
                        <lightning-layout-item size="2" padding="around-small" >
                            <lightning-input label="사원" name="enter-search" type="search" value={singleSearchEmpNum} onchange={changeHandleSearch}  onkeypress={handleEnter} onfocus={handleClick}></lightning-input>
                        </lightning-layout-item>
                        <lightning-layout-item flexibility="grow" padding="around-small" ></lightning-layout-item>
                        <lightning-layout-item size="auto" padding="around-small" class="search-button-item"  >
                            <lightning-button label="조회" variant="brand" onclick={handleTaxbtn} class="search-button"></lightning-button>
                        </lightning-layout-item>
                        <template if:true={IsShow}>
                            <c-cjfw-account-search-modal 
                                onsetsearchacc={handleSearchKey} >
                            </c-cjfw-account-search-modal>
                        </template>
                    </lightning-layout>
                </lightning-layout>
            </lightning-card>
            <!-- 필터 영역 End -->

            <!-- Data Table -->
            <lightning-card>
                <lightning-tabset variant="scoped">
                    <!-- 상세 조회 Tab End-->
                    <lightning-tab label="상세 조회">
                        <div class="slds-scrollable_x">
                            <table class="slds-table slds-table_bordered slds-table_cell-buffer slds-table_col-bordered">
                                <!-- Column -->
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th class="row-number fiexedHeader">
                                            <lightning-input type="checkbox" checked={isAllSelected} onchange={handleSelectAll}></lightning-input>
                                        </th>
                                        <th class="slds-text-title_caps">No</th>
                                        <th class="slds-text-title_caps">청구처</th>
                                        <th class="slds-text-title_caps">청구처 명</th>
                                        <th class="slds-text-title_caps">고객사</th>
                                        <th class="slds-text-title_caps">고객사 명</th>
                                        <th class="slds-text-title_caps">증빙일자</th>
                                        <th class="slds-text-title_caps">발행유형</th>
                                        <th class="slds-text-title_caps">상품코드</th>
                                        <th class="slds-text-title_caps">상품명</th>
                                        <th class="slds-text-title_caps">공급가액</th>
                                        <th class="slds-text-title_caps">새약</th>
                                        <th class="slds-text-title_caps">총액</th>
                                        <th class="slds-text-title_caps">빌링문서번호</th>
                                        <th class="slds-text-title_caps">주류여부</th>
                                    </tr>
                                </thead>
                                <!-- Column End -->

                                <!-- Data List -->
                                <tbody>
                                    <template for:each={data} for:item="item" for:index="index">
                                        <tr class="slds-hint-parent" key={item.id} data-index={index} onclick={handleClick} ondblclick={handleDoubleClick}>
                                            <td>
                                                <lightning-input type="checkbox" checked={item.isSelected} data-id={item.id} onchange={handleRowSelect}></lightning-input>
                                            </td>
                                            <td class="cell-disable slds-text-align_left">
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.index}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.taxStatus}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.errMessage}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.taxReportStatus}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.electronicDocNum}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.customerName}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.teamName}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                    <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.customerName}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.managerMA}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.publishDate}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.createdDate}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.supplyValue}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.taxAmount}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.totalMount}</div>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                                <!-- Data List End-->
                            </table>
                        </div>
                    </lightning-tab>
                    <!-- 상세 조회 Tab End-->

                    <lightning-tab label="발행 집계">
                        <div class="slds-scrollable_x">
                            <table class="slds-table slds-table_bordered slds-table_cell-buffer slds-table_col-bordered">
                                <!-- Column -->
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th class="row-number fiexedHeader">
                                            <lightning-input type="checkbox" checked={isAllSelected} onchange={handleSelectAll}></lightning-input>
                                        </th>
                                        <th class="slds-text-title_caps">No</th>
                                        <th class="slds-text-title_caps">청구처</th>
                                        <th class="slds-text-title_caps">청구처 명</th>
                                        <th class="slds-text-title_caps">고객사</th>
                                        <th class="slds-text-title_caps">고객사 명</th>
                                        <th class="slds-text-title_caps">증빙일자</th>
                                        <th class="slds-text-title_caps">발행유형</th>
                                        <th class="slds-text-title_caps">상품코드</th>
                                        <th class="slds-text-title_caps">상품명</th>
                                        <th class="slds-text-title_caps">공급가액</th>
                                        <th class="slds-text-title_caps">새약</th>
                                        <th class="slds-text-title_caps">총액</th>
                                        <th class="slds-text-title_caps">빌링문서번호</th>
                                        <th class="slds-text-title_caps">주류여부</th>
                                    </tr>
                                </thead>
                                <!-- Column End -->

                                <!-- Data List -->
                                <tbody>
                                    <template for:each={data1} for:item="item" for:index="index">
                                        <tr class="slds-hint-parent" key={item.id} data-index={index} onclick={handleClick} ondblclick={handleDoubleClick}>
                                            <td>
                                                <lightning-input type="checkbox" checked={item.isSelected} data-id={item.id} onchange={handleRowSelect}></lightning-input>
                                            </td>
                                            <td class="cell-disable slds-text-align_left">
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.index}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.taxStatus}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.errMessage}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.taxReportStatus}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.privousDocNum}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.electronicDocNum}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.customerCode}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.customerName}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.teamName}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.managerMA}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.publishDate}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.createdDate}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.supplyValue}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.taxAmount}</div>
                                            </td>
                                            <td class="cell-disable slds-text-align_left" >
                                                <div class="slds-truncate slds-truncate slds-truncate_container_66">{item.totalMount}</div>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                                <!-- Data List End-->
                            </table>
                        </div>
                    </lightning-tab>
                </lightning-tabset>    
            </lightning-card>
            <!--Data Table End-->
        </lightning-modal-body>
        <!-- #Body End-->

        <!-- #Footer -->
        <lightning-modal-footer>
            <div class="slds-clearfix">
                <div class="slds-float_right">
                    <lightning-button variant="neutral" label="취소" onclick={handleClose} class="slds-m-left_x-small"></lightning-button>
                    <lightning-button variant="brand" label="발행 전송" onclick={handleNext} class="slds-m-left_x-small"></lightning-button>
                </div>
              </div>
        </lightning-modal-footer>
        <!-- #Footer End-->
    </Template>
</template>