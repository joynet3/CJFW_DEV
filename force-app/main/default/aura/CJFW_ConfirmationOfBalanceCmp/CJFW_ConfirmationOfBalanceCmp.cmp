<!--
* ==================================================================================
*   File Name   : ConfirmationOfBalance.cmp
*   Author      : yeonji.lim
*   Date        : 2023.08.21
*   Description : 잔고확인서 생성 Aura component
*   Modification Log
* ==================================================================================
*   Ver     Date          Author          Modification
* ==================================================================================
*   1.0     2023.08.21    yeonji.lim      Create
* ==================================================================================
-->

<aura:component implements="force:appHostable,flexipage:availableForAllPageTypes,force:lightningQuickActionWithoutHeader,force:hasRecordId,lightning:isUrlAddressable">

    <!-- CSS -->
    <aura:html tag="style">
        .slds-modal__container{
            min-width: 80% !important;
            max-width: fit-content !important;
            padding: 0 20px;
        }

        .cuf-content {
            padding: 0 0rem !important;
        }

        .slds-p-around--medium {
            padding: 0rem !important;
        }

        .slds-modal__content {
            overflow-y: hidden !important;
            height: unset !important;
            max-height: unset !important;
        }
    </aura:html>


    <!-- Page Attribute -->
    <aura:attribute name="recordId" type="String" description=""/>
    <aura:attribute name="prefix" type="String" description="현 Org Base URL"/>
    <aura:attribute name="vfPageUrl" type="String" description="미리보기 Vfp 주소"/>
    <aura:attribute name="saveType" Type="String" description="파일 생성 유형 (PDF/Excel)"/>    

    <!-- Etc. Attribute -->
    <aura:attribute name="isMobile" type="Boolean" default="false" description="Mobile, DeskTop 구분자"/>
    <aura:attribute name="showSpinner" type="Boolean" description="Spinner"/>
    
    <!-- Handler -->
    <aura:handler name="init" value="{!this}" action="{!c.fnInit}"/>

    <!-- Contents -->
    <aura:if isTrue="{!v.showSpinner}">
        <lightning:spinner alternativeText="Loading" size="large" variant="brand" />
    </aura:if>

    <!-- modal header -->
    <!-- 견적 파일 생성 미리보기 화면 -->
    <aura:if isTrue="{!!v.isMobile}">
        <div class="slds-col modal-header slds-modal__header">
            <h2 class="title slds-text-heading_medium">
                잔고확인서 파일 생성 미리보기
            </h2>
        </div>
    </aura:if>

    <!-- modal Content -->
    <div class="modal-body slds-modal__content" style="{!v.isMobile ? 'position:relative;min-height:90vh; margin:0; padding:0':'position:relative;min-height:80vh;'}">
        <aura:if isTrue="{!v.isMobile}">
            <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table--fixed-layout" style="height:10vh;padding-top:1vh;padding-bottom:1vh;width:100%;text-align:center;background-color:rgb(250, 250, 249);">
                <tr>         
                    <td style="text-align:center; padding-bottom:0px">                                
                        <lightning:icon iconName="action:back"  size="x-small" onclick="{!c.fnCancel}"/>
                        <br/>
                        <small><small>닫기</small></small>
                    </td>   
                    <td style="text-align:center; padding-bottom:0px">
                        <lightning:icon aura:id="PDF" iconName="action:record" class="Icon_Red" size="x-small" onclick="{!c.fnCreateFile}"/>
                        <br/>
                        <small><small>PDF로 저장</small></small>
                    </td>             
                </tr>
            </table>
        </aura:if>
        
        <!-- spinner -->
        <div style="position:absolute; line-height: 80vh; width:100%; min-height:inherit; text-align:center"> 
            <b><big>미리보기를 생성중 입니다. 잠시 기다려주세요</big></b> 
        </div>

        <!-- visualforce page -->
        <iframe aura:id="vfFrameMaster" class="iFrameStyle" src="{!v.vfPageUrl}" style="position:absolute; width:100%; min-height:inherit;"/>
        
    </div>
        
    <!-- modal footer -->
    <aura:if isTrue="{!!v.isMobile}">
        <div class="slds-col modal-footer slds-modal__footer">
            <lightning:button variant="neutral" label="닫기" onclick="{!c.fnCancel}"/>
            <lightning:button aura:id="PDF" variant="brand" label="PDF로 저장" onclick="{!c.fnCreateFile}"/>
        </div>
    </aura:if>

</aura:component>